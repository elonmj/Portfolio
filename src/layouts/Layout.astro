---
import "../styles/global.css";

export interface Props {
    title: string;
    description?: string;
    image?: string;
    type?: "website" | "article";
}

const {
    title,
    description = "Portfolio personnel - Développeur web passionné",
    image = "/images/og-image.jpg",
    type = "website",
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---

<!doctype html>
<html lang="fr" class="scroll-smooth">
    <head>
        <meta charset="UTF-8" />
        <meta name="description" content={description} />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="generator" content={Astro.generator} />

        <!-- Canonical URL -->
        <link rel="canonical" href={canonicalURL} />

        <!-- Primary Meta Tags -->
        <title>{title}</title>
        <meta name="title" content={title} />
        <meta name="description" content={description} />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content={type} />
        <meta property="og:url" content={Astro.url} />
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:image" content={new URL(image, Astro.url)} />

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:url" content={Astro.url} />
        <meta property="twitter:title" content={title} />
        <meta property="twitter:description" content={description} />
        <meta property="twitter:image" content={new URL(image, Astro.url)} />

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&display=swap"
            rel="stylesheet"
        />

        <!-- Theme Script -->
        <script is:inline>
            // Theme initialization
            const getThemePreference = () => {
                if (
                    typeof localStorage !== "undefined" &&
                    localStorage.getItem("theme")
                ) {
                    return localStorage.getItem("theme");
                }
                return window.matchMedia("(prefers-color-scheme: dark)").matches
                    ? "dark"
                    : "light";
            };

            const isDark = getThemePreference() === "dark";
            document.documentElement.classList[isDark ? "add" : "remove"](
                "dark",
            );
        </script>
    </head>

    <body
        class="bg-white dark:bg-[#0a0910] text-stone-950 dark:text-white font-manrope antialiased transition-colors duration-300"
    >
        <slot />

        <!-- Theme Toggle Script -->
        <script>
            // Theme toggle functionality
            function toggleTheme() {
                const element = document.documentElement;
                element.classList.toggle("dark");

                const isDark = element.classList.contains("dark");
                localStorage.setItem("theme", isDark ? "dark" : "light");
            }

            // Attach to theme toggle buttons
            document.addEventListener("DOMContentLoaded", () => {
                const themeToggle = document.getElementById("theme-toggle");
                if (themeToggle) {
                    themeToggle.addEventListener("click", toggleTheme);
                }
            });
        </script>
    </body>
</html>

<style>
    html {
        font-family: "Manrope", system-ui, sans-serif;
    }
</style>
